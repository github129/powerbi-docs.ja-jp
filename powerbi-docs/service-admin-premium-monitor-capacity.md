---
title: Premium 容量メトリック アプリを使用して Power BI Premium 容量を監視します。
description: Power BI 管理ポータルと Power BI Premium 容量メトリック アプリを使用する
author: minewiskan
ms.author: owend
manager: kfile
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-admin
ms.topic: conceptual
ms.date: 02/05/2019
LocalizationGroup: Premium
ms.openlocfilehash: c4e919de95c86051257ddc38b65c4dfda78dfc03
ms.sourcegitcommit: 54d44deb6e03e518ad6378656c769b06f2a0b6dc
ms.translationtype: HT
ms.contentlocale: ja-JP
ms.lasthandoff: 02/07/2019
ms.locfileid: "55794609"
---
# <a name="monitor-premium-capacities-with-the-app"></a>アプリで Premium 容量を監視する

Premium 容量リソースを最適に利用するにはどうすればよいかを十分な情報に基づいて判断するには、ご利用の容量を監視することが不可欠です。 管理ポータルまたは **Power BI Premium 容量メトリック** アプリで容量を監視できます。 この記事では、Premium 容量メトリック アプリの使い方について説明します。 このアプリを使用すると、自分の容量がどのように活用されているかについて非常に詳細な情報を得ることができます。 過去 7 日間の平均使用量のメトリックに関する大まかな概要は、管理ポータルを使用して確認できます。 このポータルでの監視の詳細については、[管理ポータルでの Premium 容量の管理](service-admin-premium-monitor-portal.md)に関するページを参照してください。

アプリは定期的に新しい機能によって更新されます。 最新のバージョンが実行されていることを確認してください。
**アプリの最新バージョンは 1.10.1.1 (2019 年 2 月 5 日)** です。   
アプリの以前のバージョンが既にインストールされている場合は、それをご利用のアプリの中から削除し、Ctrl + F5 キーを押して更新することをお勧めします。 

## <a name="install-the-app"></a>アプリをインストールする

[Premium 容量メトリック アプリ](https://app.powerbi.com/groups/me/getapps/services/capacitymetrics)に直接移動するか、Power BI の他のアプリと同じようにインストールします。


1. Power BI で **[アプリ]** をクリックします。   
    ![アプリに移動する](media/service-admin-premium-monitor-capacity/apps.png)

2. 右側にある **[アプリの取得]** をクリックします。
3. **[アプリ]** カテゴリで、**[Power BI Premium Capacity Metrics app]\(Power BI Premium 容量メトリック アプリ\)** を検索します。
4. サブスクライブして、アプリをインストールします。

しばらくお待ちください。 インストールおよびメトリックの更新には数分かかります。 アプリに空のメトリックスが表示される場合は、F5 キーを押してブラウザーを更新します。


## <a name="get-app-refresh-history"></a>アプリの更新履歴を取得する

ご使用の Premium 容量メトリック アプリが最後に更新された時刻を確認するには、**[設定]** > **[データセット]** > **[Power BI Premium Capacity Metrics app]\(Power BI Premium 容量メトリック アプリ\)** > **[更新履歴]** の順にクリックします。 

![[設定] での更新履歴](media/settings-refresh-history.png)

最終更新日時が表示されます。スケジュールされた更新またはオンデマンドの更新を参照するには **[更新履歴]** をクリックしてください。

![最終更新日時](media/service-admin-premium-monitor-capacity/settings-last-refresh.png)

## <a name="monitor-a-capacity-with-the-app"></a>アプリを使用して容量を監視する

アプリをインストールしたので、組織で容量に関するメトリックを確認できるようになりました。 利用できる主要なメトリックをいくつか見てみましょう。

### <a name="metrics-dashboard"></a>メトリック ダッシュボード

アプリを開くと、管理者権限があるすべての容量の概要を含むダッシュボードが最初に表示されます。

![トリック アプリ ダッシュボード](media/service-admin-premium-monitor-capacity/app-dashboard.png)

このダッシュボードには次のメトリックが含まれています。

| **レポート セクション** | **メトリック** |
| --- | --- |
| **システムの概要** |  アプリケーションのバージョン<br>  自分が管理者となる容量の数<br>  メトリックを報告する容量におけるワークスペースの数<br>  過去 7 日間の平均メモリ使用量 (GB)<br>  過去 7 日間の最大メモリ使用量 (GB)<br>  メモリ使用量が最大となったときの現地時刻<br>  過去 7 日間で CPU がしきい値の 80% を超えた回数 (3 分間のバケットに分割)<br>  過去 7 日間で CPU が 80% を超えた最大回数 (1 時間のバケットに分割)<br>  CPU が 80% を超えた回数が 1 時間で最も多かったときの現地時刻 |
| **データセットの概要** |  自分の容量におけるすべてのワークスペースでのデータセットの総数<br>  過去 7 日間で直接クエリ/ライブ接続がしきい値の 80% を超えた回数 (3 分間のバケットに分割)<br>  過去 7 日間で直接クエリ/ライブ接続が 80% を超えた最大回数 (1 時間のバケットに分割)<br>  直接クエリ/ライブ接続が 80% を超えた回数が 1 時間で最も多かったときの現地時刻<br>  過去 7 日間の更新の合計数<br>  更新の平均待機時間 - スケジュールされた時間と更新の開始の間の平均ラグ (分)<br>  平均更新時間 - 更新完了にかかった時間 (分)<br>  過去 7 日間のクエリ実行の合計数<br>  平均クエリ待機時間 - 実行開始までにクエリがシステム リソース上で待機した時間 (ミリ秒)<br>  平均クエリ時間 - クリエの完了にかかった時間 (ミリ秒)<br>  メモリ不足により解放されたモデルの合計数<br>  データセットの平均サイズ <br>  メモリに読み込まれるデータセットの平均数 |
| **データフローの概要** |  自分の容量におけるすべてのワークスペースでのデータフローの総数<br>  過去 7 日間の更新の合計数<br>  更新の平均待機時間 - スケジュールされた時間と更新の開始の間の平均ラグ (分)<br>  平均更新時間 - 更新完了にかかった時間 (分) |
| **ページ分割されたレポートの概要** |  自分の容量におけるすべてのワークスペースでのページ分割されたレポートの総数<br>  すべてのレポートがユーザーに閲覧された回数の合計<br>  すべてのレポートにおけるデータ行の総数<br>  すべてのレポートのすべての段階 (データの取得、処理、レンダリング) にかかる総時間 (ミリ秒) |
|  |  |

### <a name="metrics-report"></a>メトリック レポート

ダッシュボードをクリックして、基になるレポートに移動します。 レポートの下部には次の 5 つのタブがあります。

* [**[データセット]**](#datasets) - ご自分の容量内の Power BI データセットの正常性に関する詳細なメトリック。

* [**[ページ分割されたレポート]**](#paginated-reports) - ご自分の容量内のページ分割されたレポートの正常性に関する詳細なメトリック。

* [**[データフロー]**](#dataflows) - ご自分の容量内のデータフローの詳細な更新のメトリック。

* [**[リソース消費]**](#resource-consumption) - メモリや CPU の高使用率など、全体的な容量メトリック。

* [**[ID と情報]**](#ids-and-info) - 容量、ワークスペース、およびワークロードの名前、ID、および所有者。

各タブでは、容量や日付の範囲を基準にメトリックをフィルター処理できます。 フィルターが選択されていない場合、メトリックを報告しているすべての容量に対して、過去 1 週間のメトリックが既定でレポートに表示されます。 

#### <a name="datasets"></a>データセット

**[データセット]** タブの一番上にあるボタンを使用し、各領域、すなわち、**[Refreshes]\(更新\)**、**[クエリ期間]**、**[クエリ待機]**、**[データセット]** の順に移動します。

##### <a name="refreshes-area"></a>[Refreshes]\(更新\) タブ

**[Refreshes]\(更新\)** 領域には次のメトリックが含まれています。

| **レポート セクション** | **メトリック** |
| --- | --- |
| **Refresh reliability\(更新の信頼性\)** |  合計数: 各データセットの合計更新数<br>  信頼性: 各データセットの完了した更新の割合<br>  Avg Wait Time\(平均待機時間\): データセットの更新のスケジュールされた時間と開始の間の平均ラグ (分)<br>  Max Wait Time\(最大待機時間\): * データセットの最大待機時間 (分) <br>  Avg Duration\(平均実行時間\): データセットの更新の平均実行時間 (分)<br>  Max Duration\(最大実行時間\): データセットの最も時間のかかる更新の実行時間 (分) |
| **Top 5 Datasets by Average Refresh Duration\(上位 5 件のデータセット (平均更新時間別)\)** |  平均更新時間 (分) が最も長い 5 件のデータセット |
| **Top 5 Datasets by Average Wait Time\(上位 5 件のデータセット (平均待機時間別)\)** |  更新の平均待機時間 (分) が最も長い 5 件のデータセット |
| **Hourly Average Refresh Wait Times\(1 時間ごとの更新の平均待機時間\)** |  更新の平均待機時間 (1 時間のバケットに分割、ローカル時刻で報告)。 更新待機時間の増加を伴う複数のスパイクは、容量に波があることを示しています。 |
| **Hourly Refresh Count and Memory Consumption\(1 時間ごとの更新数とメモリ消費量\)** |  成功数、失敗数、およびメモリ消費量 (1 時間のバケットに分割、ローカル時刻で報告) |
|  |  |

##### <a name="query-durations-area"></a>[Query Durations]\(クエリ実行期間\) 領域

**[Query Durations]\(クエリ実行時間\)** 領域には次のメトリックが含まれています。

| **レポート セクション** | **メトリック** |
| --- | --- |
| **Query Durations\(クエリ実行時間\)** |  このセクションのデータは、過去 7 日間におけるデータセット、ワークスペース、および時間単位のバケット数によって分割されます<br>  合計:データセットに対して実行されたクエリの合計数<br>  平均: データセットの平均クエリ時間 (ミリ秒)<br>  最大: データセット内の最も時間のかかるクエリの実行時間 (ミリ秒)|
| **Query Duration Distribution\(クエリ実行時間の分布\)** |  クエリ実行時間ヒストグラムは、クエリ実行時間 (ミリ秒) を次のカテゴリに分類して収集したものです: 30 ミリ秒以下、30 ミリ秒から 100 ミリ秒、100 ミリ秒から 300 ミリ秒、300 ミリ秒から 1 秒、1 秒から 3 秒、3 秒から 10 秒、10 秒から 30 秒、および 30 秒より長い間隔。 クエリ実行時間と待機時間が長い場合は、容量に波があることを示しています。 また、1 つのデータセットが問題の原因であり、さらなる調査が必要であることを意味する可能性もあります。 |
| **Top 5 Datasets by Average Wait Time\(上位 5 件のデータセット (平均実行時間別)\)** |  平均クエリ時間 (ミリ秒) が最も長い 5 件のデータセット |
| **Direct Query / Live Connections (> 80% Utilization)\(直接クエリ/ライブ接続 (80% を超える使用率)\)** |  直接クエリまたはライブ接続が CPU 使用率 80% を超えた時間 (1 時間のバケットに分割、ローカル時刻で報告) |
| **Hourly Query Duration Distributions\(1 時間ごとのクエリ実行時間の分布\)** |  クエリ数と平均実行時間 (ミリ秒) に対するメモリ消費量 (GB) (1 時間のバケットに分割、ローカル時刻で報告) |
|  |  |

##### <a name="query-waits-area"></a>[クエリ待機期間] 領域

**[Query Waits]\(クエリ待機時間\)** 領域には次のメトリックが含まれています。

| **レポート セクション** | **メトリック** |
| --- | --- |
| **Query Wait Times\(クエリ待機時間\)** |  このセクションのデータは、過去 7 日間におけるデータセット、ワークスペース、および時間単位のバケット数によって分割されます<br>  合計:データセットに対して実行されたクエリの合計数<br>  Wait count\(待機数\): 実行を開始する前にシステム リソースを待機していたデータセット内のクエリの数 <br>  平均: データセットのクエリの平均待機時間 (ミリ秒)<br>  最大: データセット内のクエリの最も長い待機時間 (ミリ秒)|
| **Wait Time Distribution\(待機時間の分布\)** |  クエリ実行時間ヒストグラムは、クエリ実行時間 (ミリ秒) を次のカテゴリに分類して収集したものです: 50 ミリ秒以下、50 ミリ秒から 100 ミリ秒、100 ミリ秒から 200 ミリ秒、200 ミリ秒から 400 ミリ秒、400 ミリ秒から 1 秒、1 秒から 5 秒、5 秒より長い間隔 |
| **Top 5 Datasets by Average Wait Time\(上位 5 件のデータセット (平均待機時間別)\)** |  クエリの実行を開始するまでの平均待機時間 (ミリ秒) が最も長い 5 件のデータセット |
| **Hourly Query Wait Counts and Times\(1 時間ごとのクエリの待機数と時間\)** |  クエリ待機数と平均待機時間 (ミリ秒) に対するメモリ消費量 (GB) (1 時間のバケットに分割、ローカル時刻で報告) |
|  |  |

##### <a name="datasets-area"></a>[データセット] 領域

**[データセット]** 領域には次のメトリックが含まれています。

| **レポート セクション** | **メトリック** |
| --- | --- |
| **Dataset Eviction Counts\(データセットの削除数\)** |  合計:容量ごとのデータセットの*削除*の合計数。 容量でメモリ不足が発生した場合は、ノードでメモリから 1 つまたは複数のデータセットが削除されます。 非アクティブなデータセット (現在、実行している操作のクエリ/更新なし) が最初に削除されます。 次に、削除の順序は、'最も長く使われていない' (LRU) のメジャーに基づいています。|
| **Hourly Dataset Evictions and Memory Consumption\(1 時間ごとのデータセットの削除数とメモリ消費量\)** |  データセットの削除数に対するメモリ消費量 (GB) (1 時間のバケットに分割、ローカル時刻で報告) |
| **Hourly Loaded Dataset Counts**\(1 時間ごとに読み込まれたデータセットの数\) |  メモリに読み込まれるデータセット数に対するメモリ消費量 (GB) (1 時間のバケットに分割、ローカル時刻で報告) |
| **Consumed Memory Percentages\(消費されたメモリの割合\)** |  メモリ内でアクティブなデータセットの合計 (合計メモリに対する割合で示される)。 アクティブなデータセットと、解放可能なすべての define データセットとの差分。 過去 7 日間の値が時間単位で表示されます。 |
| **Data Sizes**\(データ サイズ\)  |  最大サイズ: 表示されている期間のデータセットの最大サイズ (MB) |
|  |  |

#### <a name="paginated-reports"></a>ページ分割されたレポート

**[ページ分割されたレポート]** タブには、容量内のページ分割されたレポートの正常性に関する詳細なメトリックが表示されます。

| **レポート セクション** | **メトリック** |
| --- | --- |
| **Overall usage\(全体の使用状況\)** |  合計表示回数: レポートがユーザーによって表示された回数<br>  行数: レポート内のデータの行数<br>  Retrieval (avg)\(取得 (平均)\): レポートのデータの取得にかかる平均時間 (ミリ秒)。 この時間が長い場合は、低速クエリまたはデータ ソースのその他の問題を示している可能性があります。 <br>  Processing (avg)\(処理 (平均)\): レポートのデータの処理にかかる平均時間 (ミリ秒)<br> Rendering (avg)\(表示 (平均)\): ブラウザーでのレポートの表示にかかる平均時間 (ミリ秒)<br>  合計時間: レポートのすべてのフェーズにかかる時間 (ミリ秒)|
| **Top 5 Reports by Average Data Retrieval Time\(上位 5 件のレポート (平均データ取得時間別)\)** |  平均データ取得時間 (ミリ秒) が最も長い 5 件のレポート |
| **Top 5 Reports by Average Report Processing Time\(上位 5 件のレポート (平均レポート処理時間別)\)** |  平均レポート処理時間 (ミリ秒) が最も長い 5 件のレポート |
| **Hourly Durations\(1 時間ごとの実行時間\)** |  データ取得時間に対するデータ処理時間とデータ表示時間 (1 時間のバケットに分割、ローカル時刻で報告) |
| **Hourly Results\(1 時間ごとの結果\)** |  成功数、失敗数、およびメモリ消費量 (1 時間のバケットに分割、ローカル時刻で報告) |
|  |  |

#### <a name="dataflows"></a>データフロー

**[データフロー]** タブには、容量内のデータフローの詳細な更新のメトリックが表示されます。

| **レポート セクション** | **メトリック** |
| --- | --- |
| **Refresh\(更新\)** |  合計:各データフローの合計更新数<br>  信頼性: 各データフローの完了した更新の割合<br>  Avg Wait Time\(平均待機時間\): データフローの更新のスケジュールされた時間と開始の間の平均ラグ (分)<br>  Max Wait Time\(最大待機時間\): データフローの最大待機時間 (分) <br>  Avg Duration\(平均実行時間\): データフローの更新の平均実行時間 (分)<br>  Max Duration\(最大実行時間\): データフローの最も時間のかかる更新の実行時間 (分) |
| **Top 5 dataflows by Average Refresh Duration\(上位 5 件のデータフロー (平均更新時間別)\)** |  平均更新時間 (分) が最も長い 5 件のデータフロー |
| **Top 5 dataflows by Average Wait Time\(上位 5 件のデータフロー (平均待機時間別)\)** |  更新の平均待機時間 (分) が最も長い 5 件のデータフロー |
| **Hourly Average Refresh Wait Times\(1 時間ごとの更新の平均待機時間\)** |  更新の平均待機時間 (1 時間のバケットに分割、ローカル時刻で報告)。 更新待機時間の増加を伴う複数のスパイクは、容量に波があることを示しています。 |
| **Hourly Refresh Count and Memory Consumption\(1 時間ごとの更新数とメモリ消費量\)** |  成功数、失敗数、およびメモリ消費量 (1 時間のバケットに分割、ローカル時刻で報告) |
|  |  |

#### <a name="resource-consumption"></a>リソース消費量

**[リソース消費]** タブには、すべての容量とワークロードにわたる CPU とメモリの消費量が表示されます。

| **レポート セクション** | **メトリック** |
| --- | --- |
| **CPU 消費量** |  ワークロードによる消費量 (CPU の合計容量に対する割合)。 過去 7 日間の値が時間単位で表示されます。 |
| **メモリ消費量** |  ワークロードによるメモリ消費量 (GB) (実線) にワークロードの上限 (点線) が重ねて表示されます。 過去 7 日間の値が時間単位で表示されます。 |
|  |  |

#### <a name="ids-and-info"></a>ID と情報

**[ID と情報]** タブには、容量の名前、ID、所有者、ワークスペース、ワークロードが含まれています。


## <a name="monitor-power-bi-embedded-capacity"></a>Power BI Embedded 容量を監視する

Power BI Premium 容量メトリック アプリを使用して、Power BI Embedded の *A SKU* 容量を監視することができます。 これらの容量は、容量の管理者であればレポートに表示されます。 ただし、A SKU で Power BI に特定のアクセス許可を付与しない限り、レポートの更新は失敗します。

1. Azure Portal で容量を開きます。

1. **[アクセス制御 (IAM)]** をクリックして、リーダー ロールに "Power BI Premium" を追加します。 名前でアプリを検索できない場合は、クライアント ID (cb4dc29f-0bf4-402a-8b30-7511498ed654) で追加することもできます。

    ![Power BI Embedded のアクセス許可](media/service-admin-premium-monitor-capacity/embedded-permissions.png)

> [!NOTE]
> アプリまたは Azure Portal でPower BI Embedded 容量使用率を監視することができますが、Power BI 管理ポータルではできません。


## <a name="next-steps"></a>次の手順

> [!div class="nextstepaction"]
> [Power BI Premium 容量のリソースの管理と最適化](service-premium-understand-how-it-works.md)
